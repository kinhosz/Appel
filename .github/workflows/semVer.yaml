name: Update version
on:
  pull_request_target:
    types:
      - closed
  push:

jobs:
  if_merged:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
    - name: Was Merged
      run: echo Was merged
  
  update_major:
#    needs: if_merged
    if: startsWith(github.ref_name, 'break/')
    runs-on: ubuntu-latest
    steps:
    - name: Setting major version
      run: echo update MAJOR

  update_minor:
#    needs: if_merged
    if: startsWith(github.ref_name, 'feat/')
    runs-on: ubuntu-latest
    steps:
    - name: Setting minor version
      run: echo update minor
  
  is_not_major:
    if: ${{ always() }} && needs.update_major.result != 'success'
    needs: update_major
    runs-on: ubuntu-latest
    steps:
    - run: echo is not major ${{ needs.update_major }}
  
  is_not_minor:
    if: ${{ always() }} && needs.update_minor.result != 'success'
    needs: update_minor
    runs-on: ubuntu-latest
    steps:
    - run: echo is not minor

  update_patch:
    needs: [is_not_major, is_not_minor]
    runs-on: ubuntu-latest
    steps:
    - name: setting patch version
      run: echo update patch
  
  commit_changes:
    if: ${{ always() }}
    needs: [update_major, update_minor, update_patch]
    runs-on: ubuntu-latest
    steps:
    - name: Setting checkout
      uses: actions/checkout@v3
    - name: See what the branch
      run: git branch
    
    - name: See github.ref_name
      run: echo ${{ github.ref_name }}
